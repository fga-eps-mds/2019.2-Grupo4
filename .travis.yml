sudo: required
language: python # Set the build language to Python

install:
- pip install mkdocs
- pip install mkdocs-material
- pip install mkdocs-awesome-pages-plugin

script:
    - mkdocs build --verbose --clean # Build a local version of the docs
    - openssl aes-256-cbc -K $encrypted_f7d66ec079b1_key -iv $encrypted_f7d66ec079b1_iv -in deploy-key.enc -out deploy-key -d
    - chmod 600 deploy-key
    - eval `ssh-agent -s`
    - ssh-add deploy-key
    - git config user.name "Automatic Publish"
    - git config user.email "danillosouza1704@gmail.com"
    - git remote add gh-token "${GH_REF}";
    - git fetch gh-token && git fetch gh-token gh-pages:gh-pages;
    - if [ "${TRAVIS_PULL_REQUEST}" = "false" ]; then echo "Pushing to github"; PYTHONPATH=src/ mkdocs gh-deploy -v --clean --remote-name gh-token; git push gh-token gh-pages; fi;

deploy: # Deploy documentation to Github in the gh_pages branch
    provider: pages
    skip_cleanup: true
    github_token: $GITHUB_TOKEN
    local_dir: site
    on:
        branch: docs